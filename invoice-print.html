<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoice - Jesyca Shop</title>
    <style>
        /* CSS untuk print dot matrix pada kertas wartel */
        @media print {
            @page {
                size: 80mm auto;
                margin: 2mm;
            }
            
            body {
                margin: 0;
                padding: 0;
                font-family: 'Courier New', monospace;
                font-size: 9px;
                line-height: 1.2;
                color: black;
                background: white;
            }
            
            .no-print {
                display: none !important;
            }
        }
        
        body {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.3;
            max-width: 300px;
            margin: 0 auto;
            padding: 10px;
            background: #f9f9f9;
        }
        
        .invoice-container {
            background: white;
            padding: 10px;
            border: 1px solid #ddd;
        }
        
        .header {
            text-align: center;
            border-bottom: 1px dashed #000;
            padding-bottom: 8px;
            margin-bottom: 8px;
        }
        
        .company-name {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 2px;
        }
        
        .company-info {
            font-size: 10px;
            margin: 1px 0;
        }
        
        .invoice-details {
            margin: 8px 0;
            font-size: 10px;
        }
        
        .customer-section {
            margin: 8px 0;
            border-bottom: 1px dashed #000;
            padding-bottom: 8px;
        }
        
        .date-section {
            text-align: right;
            margin-bottom: 8px;
            font-size: 10px;
        }
        
        .items-header {
            border-bottom: 1px solid #000;
            padding: 2px 0;
            font-weight: bold;
            font-size: 10px;
        }
        
        .item-row {
            padding: 2px 0;
            border-bottom: 1px dotted #ccc;
            font-size: 10px;
        }
        
        .item-name {
            display: inline-block;
            width: 60%;
        }
        
        .item-price {
            display: inline-block;
            width: 35%;
            text-align: right;
        }
        
        .totals-section {
            margin-top: 8px;
            border-top: 1px dashed #000;
            padding-top: 5px;
            font-size: 10px;
        }
        
        .total-row {
            display: flex;
            justify-content: space-between;
            margin: 2px 0;
        }
        
        .grand-total {
            font-weight: bold;
            border-top: 1px solid #000;
            padding-top: 2px;
            margin-top: 3px;
        }
        
        .bank-info {
            text-align: center;
            margin-top: 8px;
            border-top: 1px dashed #000;
            padding-top: 5px;
            font-size: 9px;
        }
        
        .form-section {
            margin: 10px 0;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 5px;
        }
        
        .form-group {
            margin: 8px 0;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 3px;
            font-weight: bold;
            font-size: 11px;
        }
        
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 11px;
        }
        
        .product-row {
            display: flex;
            gap: 5px;
            margin: 5px 0;
            align-items: center;
        }
        
        .product-row input {
            flex: 1;
        }
        
        .product-row .price-input {
            width: 80px;
            flex: none;
        }
        
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 3px;
            cursor: pointer;
            margin: 5px;
            font-size: 11px;
        }
        
        .btn:hover {
            background: #0056b3;
        }
        
        .btn-success {
            background: #28a745;
        }
        
        .btn-success:hover {
            background: #1e7e34;
        }
        
        .btn-danger {
            background: #dc3545;
            padding: 3px 8px;
            font-size: 9px;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .buttons-section {
            text-align: center;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <!-- Form Input Section (Hidden saat print) -->
    <div class="form-section no-print">
        <h3>Input Data Invoice</h3>
        
        <div class="form-group">
            <label for="customerName">Nama Pelanggan:</label>
            <input type="text" id="customerName" placeholder="Masukkan nama pelanggan">
        </div>
        
        <div class="form-group">
            <label for="customerAddress">Alamat Pelanggan:</label>
            <textarea id="customerAddress" rows="2" placeholder="Masukkan alamat pelanggan"></textarea>
        </div>
        
        <div class="form-group">
            <label>Produk yang Dibeli:</label>
            <div id="productsList">
                <div class="product-row">
                    <input type="text" placeholder="Nama produk" class="product-name">
                    <input type="number" placeholder="Harga" class="product-price price-input" min="0">
                    <button type="button" class="btn btn-danger" onclick="removeProduct(this)">×</button>
                </div>
            </div>
            <button type="button" class="btn" onclick="addProduct()">+ Tambah Produk</button>
        </div>
        
        <div class="form-group">
            <label for="amountPaid">Jumlah Dibayar:</label>
            <input type="number" id="amountPaid" placeholder="0" min="0">
        </div>
        
        <div class="form-group">
            <label for="bankAccount">Nomor Rekening:</label>
            <input type="text" id="bankAccount" placeholder="Masukkan nomor rekening" value="1234-5678-9012">
        </div>
        
        <div class="buttons-section">
            <button type="button" class="btn" onclick="updateInvoice()">Update Invoice</button>
            <button type="button" class="btn btn-success" onclick="printInvoice()">Cetak Invoice</button>
        </div>
    </div>

    <!-- Invoice Template (Yang akan dicetak) -->
    <div class="invoice-container">
        <div class="header">
            <div class="company-name">JESYCA SHOP</div>
            <div class="company-info">Jl Wilis 24 B Pare</div>
            <div class="company-info">Telp: 0857 49201950</div>
        </div>
        
        <div class="date-section">
            <div>Tanggal: <span id="transactionDate"></span></div>
        </div>
        
        <div class="customer-section">
            <div><strong>Nama:</strong> <span id="displayCustomerName">-</span></div>
            <div><strong>Alamat:</strong></div>
            <div id="displayCustomerAddress">-</div>
        </div>
        
        <div class="items-header">
            <span class="item-name">PRODUK</span>
            <span class="item-price">HARGA</span>
        </div>
        
        <div id="itemsList">
            <!-- Items akan ditambahkan di sini -->
        </div>
        
        <div class="totals-section">
            <div class="total-row">
                <span>Subtotal:</span>
                <span id="subtotalAmount">Rp 0</span>
            </div>
            <div class="total-row">
                <span>Dibayar:</span>
                <span id="paidAmount">Rp 0</span>
            </div>
            <div class="total-row">
                <span>Kurang:</span>
                <span id="balanceAmount">Rp 0</span>
            </div>
            <div class="total-row grand-total">
                <span>TOTAL:</span>
                <span id="grandTotal">Rp 0</span>
            </div>
        </div>
        
        <div class="bank-info">
            <div><strong>Nomor Rekening:</strong></div>
            <div id="displayBankAccount">1234-5678-9012</div>
            <div style="margin-top: 8px;">Terima Kasih</div>
        </div>
    </div>

    <script>
        // Set tanggal real-time saat halaman dimuat
        function updateDateTime() {
            const now = new Date();
            const dateStr = now.toLocaleDateString('id-ID', {
                day: '2-digit',
                month: '2-digit', 
                year: 'numeric'
            });
            const timeStr = now.toLocaleTimeString('id-ID', {
                hour: '2-digit',
                minute: '2-digit'
            });
            document.getElementById('transactionDate').textContent = `${dateStr} ${timeStr}`;
        }

        // Format currency
        function formatCurrency(amount) {
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: 'IDR',
                minimumFractionDigits: 0
            }).format(amount);
        }

        // Tambah produk baru
        function addProduct() {
            const productsList = document.getElementById('productsList');
            const newRow = document.createElement('div');
            newRow.className = 'product-row';
            newRow.innerHTML = `
                <input type="text" placeholder="Nama produk" class="product-name">
                <input type="number" placeholder="Harga" class="product-price price-input" min="0">
                <button type="button" class="btn btn-danger" onclick="removeProduct(this)">×</button>
            `;
            productsList.appendChild(newRow);
        }

        // Hapus produk
        function removeProduct(button) {
            const productRows = document.querySelectorAll('.product-row');
            if (productRows.length > 1) {
                button.parentElement.remove();
            } else {
                alert('Minimal harus ada satu produk!');
            }
        }

        // Update invoice dengan data dari form
        function updateInvoice() {
            // Update nama dan alamat pelanggan
            const customerName = document.getElementById('customerName').value || '-';
            const customerAddress = document.getElementById('customerAddress').value || '-';
            const bankAccount = document.getElementById('bankAccount').value || '1234-5678-9012';
            
            document.getElementById('displayCustomerName').textContent = customerName;
            document.getElementById('displayCustomerAddress').textContent = customerAddress;
            document.getElementById('displayBankAccount').textContent = bankAccount;

            // Update daftar produk
            const productRows = document.querySelectorAll('.product-row');
            const itemsList = document.getElementById('itemsList');
            itemsList.innerHTML = '';
            
            let subtotal = 0;
            
            productRows.forEach(row => {
                const productName = row.querySelector('.product-name').value;
                const productPrice = parseFloat(row.querySelector('.product-price').value) || 0;
                
                if (productName && productPrice > 0) {
                    subtotal += productPrice;
                    
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'item-row';
                    itemDiv.innerHTML = `
                        <span class="item-name">${productName}</span>
                        <span class="item-price">${formatCurrency(productPrice)}</span>
                    `;
                    itemsList.appendChild(itemDiv);
                }
            });

            // Update totals
            const amountPaid = parseFloat(document.getElementById('amountPaid').value) || 0;
            const balance = subtotal - amountPaid;
            
            document.getElementById('subtotalAmount').textContent = formatCurrency(subtotal);
            document.getElementById('paidAmount').textContent = formatCurrency(amountPaid);
            document.getElementById('balanceAmount').textContent = formatCurrency(balance);
            document.getElementById('grandTotal').textContent = formatCurrency(subtotal);
        }

        // Cetak invoice
        function printInvoice() {
            updateInvoice();
            window.print();
        }

        // Inisialisasi saat halaman dimuat
        document.addEventListener('DOMContentLoaded', function() {
            updateDateTime();
            // Update waktu setiap menit
            setInterval(updateDateTime, 60000);
            
            // Auto-update invoice saat input berubah
            const inputs = document.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                input.addEventListener('input', updateInvoice);
            });
        });
    </script>
</body>
</html>
